function doPost(e) {
  try {
    const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Hoja 1");
    const data = JSON.parse(e.postData.contents);

    sheet.appendRow([
      new Date(),
      data.nombre,
      data.telefono,
      data.correo,
      data.producto,
      data.comentarios
    ]);

    return ContentService.createTextOutput(
      JSON.stringify({ status: "success", message: "Pedido guardado" })
    ).setMimeType(ContentService.MimeType.JSON);

  } catch (err) {
    return ContentService.createTextOutput(
      JSON.stringify({ status: "error", message: err.message })
    ).setMimeType(ContentService.MimeType.JSON);
  }
}
